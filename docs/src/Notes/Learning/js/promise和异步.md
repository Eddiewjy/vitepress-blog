ä»Šå¤©æ¥å¤ä¹ ä¸€ä¸‹ **Promise** å’Œ **å¼‚æ­¥ç¼–ç¨‹**ã€‚ä¹‹å‰åªåœ¨gptä¸Šçœ‹äº†ä½†æ˜¯æ²¡æ¬è¿è¿‡æ¥ğŸ˜‡

### 1. ä»€ä¹ˆæ˜¯å¼‚æ­¥ç¼–ç¨‹ï¼Ÿ

::: tip
å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒç›®çš„æ˜¯: è®©ä»£ç åœ¨ç­‰å¾…æŸäº›æ“ä½œï¼ˆå¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ç­‰ï¼‰æ—¶ä¸é˜»å¡åç»­ä»£ç çš„æ‰§è¡Œã€‚
:::
JavaScript çš„ **å¼‚æ­¥ç¼–ç¨‹** å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼å®ç°ï¼š

- **å›è°ƒå‡½æ•°**ï¼ˆcallbackï¼‰
- **Promise**
- **async/await**

### 2. Promise ä»‹ç»

**Promise** æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºå¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰åŠå…¶ç»“æœå€¼çš„æœºåˆ¶ï¼Œå®ƒæ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§ä¼˜åŒ–æ–¹å¼ã€‚Promise ç”¨äºè§£å†³ä¼ ç»Ÿå›è°ƒå‡½æ•°çš„â€œå›è°ƒåœ°ç‹±â€é—®é¢˜ã€‚ï¼ˆå¤šä¸ªcallbackåµŒå¥—ï¼‰

#### Promise ä¸‰ç§çŠ¶æ€

- **Pending**ï¼šåˆå§‹çŠ¶æ€ï¼Œæ“ä½œå°šæœªå®Œæˆã€‚
- **Fulfilled**ï¼šæ“ä½œæˆåŠŸå®Œæˆï¼Œè¿”å›ç»“æœã€‚
- **Rejected**ï¼šæ“ä½œå¤±è´¥ï¼Œè¿”å›å¤±è´¥åŸå› ã€‚

#### Promise çš„ä½¿ç”¨

1. **åˆ›å»ºä¸€ä¸ª Promise**

```javascript
const promise = new Promise((resolve, reject) => {
  // æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ“ä½œ
  let success = true; // ä½ å¯ä»¥æ”¹å˜è¿™ä¸ªå€¼æ¥æ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥
  setTimeout(() => {
    if (success) {
      resolve("æ“ä½œæˆåŠŸï¼"); // æˆåŠŸæ—¶è°ƒç”¨ resolve
    } else {
      reject("æ“ä½œå¤±è´¥ï¼"); // å¤±è´¥æ—¶è°ƒç”¨ reject
    }
  }, 1000);
});
```

2. **å¤„ç† Promise çš„ç»“æœ**
   - ä½¿ç”¨ `.then()` å¤„ç†æˆåŠŸçš„ç»“æœã€‚->ä¸å‡†ç¡®ï¼Œthenæ˜¯æ³¨å†Œpromiseçš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœè¿”å›å€¼æ˜¯æ™®é€šå€¼ï¼Œä¼šæ­£å¸¸ä¼ é€’ç»™ä¸‹ä¸ªthenï¼›å¦‚æœè¿”å›å€¼æ˜¯promiseå¯¹è±¡ï¼Œåˆ™ä¼šç­‰å¾…è¿™ä¸ªpromiseå¯¹è±¡çš„ç»“æœã€‚
   - ä½¿ç”¨ `.catch()` å¤„ç†å¤±è´¥çš„ç»“æœã€‚

```javascript
promise
  .then((result) => {
    console.log(result); // å¦‚æœ Promise æˆåŠŸï¼Œè¾“å‡ºï¼šæ“ä½œæˆåŠŸï¼
  })
  .catch((error) => {
    console.log(error); // å¦‚æœ Promise å¤±è´¥ï¼Œè¾“å‡ºï¼šæ“ä½œå¤±è´¥ï¼
  });
```

### 3. é“¾å¼è°ƒç”¨

Promise æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨ `.then()` é‡Œè¿”å›å¦ä¸€ä¸ª Promiseï¼Œå½¢æˆé“¾å¼æ“ä½œã€‚

```javascript
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve("ç¬¬ä¸€æ­¥å®Œæˆ");
  }, 1000);
});

promise
  .then((result) => {
    console.log(result); // è¾“å‡ºï¼šç¬¬ä¸€æ­¥å®Œæˆ
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve("ç¬¬äºŒæ­¥å®Œæˆ");
      }, 1000);
    });
  })
  .then((result) => {
    console.log(result); // è¾“å‡ºï¼šç¬¬äºŒæ­¥å®Œæˆ
  })
  .catch((error) => {
    console.error(error);
  });
```

### 4. Promise.all å’Œ Promise.race

- **`Promise.all()`**ï¼šæ¥æ”¶ä¸€ä¸ª Promise æ•°ç»„ï¼Œæ‰€æœ‰ Promise å®Œæˆåæ‰ä¼šç»§ç»­æ‰§è¡Œï¼ˆè¿”å›çš„ Promise æˆåŠŸï¼Œä¸”ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼‰ã€‚
- **`Promise.race()`**ï¼šæ¥æ”¶ä¸€ä¸ª Promise æ•°ç»„ï¼Œè¿”å›æœ€å…ˆå®Œæˆçš„ Promiseã€‚

```javascript
// Promise.all()
const p1 = new Promise((resolve) => setTimeout(resolve, 1000, "ç¬¬ä¸€"));
const p2 = new Promise((resolve) => setTimeout(resolve, 2000, "ç¬¬äºŒ"));
const p3 = new Promise((resolve) => setTimeout(resolve, 1500, "ç¬¬ä¸‰"));

Promise.all([p1, p2, p3]).then((results) => {
  console.log(results); // è¾“å‡º: ['ç¬¬ä¸€', 'ç¬¬äºŒ', 'ç¬¬ä¸‰']
});

// Promise.race()
Promise.race([p1, p2, p3]).then((result) => {
  console.log(result); // è¾“å‡º: 'ç¬¬ä¸€'ï¼ˆå› ä¸º p1 æœ€å…ˆå®Œæˆï¼‰
});
```

### 5. async/await

`async` å’Œ `await` æ˜¯åŸºäº Promise çš„è¯­æ³•ç³–ï¼Œèƒ½è®©å¼‚æ­¥ä»£ç å†™èµ·æ¥æ›´åƒåŒæ­¥ä»£ç ï¼Œè¯»èµ·æ¥æ›´ç›´è§‚ã€‚

- **`async`**ï¼šå‡½æ•°è¿”å›ä¸€ä¸ª Promiseã€‚
- **`await`**ï¼šç­‰å¾… Promise å®Œæˆï¼Œå¿…é¡»åœ¨ `async` å‡½æ•°ä¸­ä½¿ç”¨ã€‚

```javascript
// ä½¿ç”¨ async/await
async function doSomething() {
  try {
    const result = await new Promise((resolve) =>
      setTimeout(resolve, 1000, "æ“ä½œå®Œæˆ")
    );
    console.log(result); // è¾“å‡ºï¼šæ“ä½œå®Œæˆ
  } catch (error) {
    console.error(error);
  }
}

doSomething();
```

#### å¼‚æ­¥é”™è¯¯å¤„ç†

ä½¿ç”¨ `async/await` æ—¶ï¼Œé”™è¯¯å¤„ç†é€šå¸¸é€šè¿‡ `try/catch` è¯­å¥æ¥å®ç°ï¼ŒåƒåŒæ­¥ä»£ç ä¸€æ ·æ•è·å¼‚å¸¸ã€‚

```javascript
async function fetchData() {
  try {
    const response = await fetch("https://api.example.com/data");
    const data = await response.json();
    console.log(data);
  } catch (error) {
    console.error("è¯·æ±‚å¤±è´¥:", error);
  }
}
```

---

### æ€»ç»“

**Promise** æä¾›äº†ä¸€ç§*æ›´æ¸…æ™°ã€å¯ç®¡ç†* çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šä¸ªå¼‚æ­¥æ“ä½œä¾èµ–äºå½¼æ­¤æ—¶ï¼Œå®ƒæ¯”å›è°ƒå‡½æ•°æ›´æ˜“äºç†è§£ã€‚è€Œ **async/await** åˆ™é€šè¿‡æ›´ç®€æ´çš„è¯­æ³•è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ï¼Œé¿å…äº†å›è°ƒåœ°ç‹±çš„å¤æ‚æ€§ã€‚

1. promiseæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨äºè¿”å›è¯·æ±‚çš„çŠ¶æ€å¹¶ä¸”æ‰§è¡Œå¯¹åº”æ“ä½œã€‚pendingçŠ¶æ€æ˜¯æ‰§è¡Œexecutorå‡½æ•°åè¿˜æ²¡æœ‰è¿”å›ï¼Œfulfilledæ˜¯è¯·æ±‚æˆåŠŸè¿”å›ï¼Œrejectedæ˜¯è¯·æ±‚è¢«æ‹’ç»ã€‚
2. promise().then((data)=> {reslove(data)}).catch((error)=> {reject(error)})
3. Promise allæ¥å—ä¸€ä¸ªpromiseçš„å¯è¿­ä»£å¯¹è±¡åŒ…æ‹¬æ•°ç»„ï¼Œé›†åˆç­‰ã€‚å¹¶ä¸”åœ¨æ‰€æœ‰promise fulfilledä»¥åè¿”å›ç»“æœåœ¨ä»»æ„ä¸€ä¸ªpromise rejectçš„æ—¶å€™ä»–ä¼šè¿”å›rejectã€‚ promise raceä¹Ÿæ˜¯æ¥å—ä¸€ä¸ªpromiseçš„æ•°ç»„ï¼Œç„¶åè¿”å›ç¬¬ä¸€ä¸ªå®Œæˆçš„ Promiseçš„å¯¹è±¡ã€‚
4. å¼‚æ­¥ç¼–ç¨‹ï¼Œå—¯ï¼Œå¯ä»¥é˜²æ­¢åœ¨æ‰§è¡ŒæŸä¸ªä»£ç çš„æ—¶å€™é˜»å¡åé¢ä»£ç çš„è¿›è¡Œã€‚Javascript å¼‚æ­¥ç¼–ç¨‹å¦‚ä½•é‡è¦ï¼Œæ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ä¼šå‡ºç°å¤šç§å®¹æ˜“å®¹æ˜“å‡ºç°é˜»å¡çš„æƒ…å†µï¼Œæ¯”å¦‚è¯´å›¾ç‰‡åŠ è½½ã€å‘å‡ºè¯·æ±‚ï¼Œå¼‚æ­¥ç¼–ç¨‹å¯ä»¥å®ç°ä¸€å®šç¨‹åº¦çš„æ‹¥å¡æ§åˆ¶ã€‚
5. ä¸æ˜¯å¾ˆç†Ÿæ‚‰å…·ä½“ä»£ç ï¼Œä½†æ˜¯çŸ¥é“promiseçš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥åˆ©ç”¨ try catch æ•è·é”™è¯¯ï¼Œæ¯”å¦‚åŠ è½½æ—¶é—´è¿‡é•¿å°±æŠ¥é”™ï¼ˆç½‘é¡µä¸Šå‡ºç°çš„æœªè¿æ¥å°±æ˜¯ä¾‹å­ï¼‰ã€‚ä¸€èˆ¬é‡åˆ°è¿™ç§æƒ…å†µæˆ‘ä¼šè¯¢é—®gptï¼Œçœ‹ä¸€ä¸‹å…·ä½“ä»£ç å’‹å†™ç„¶åæ¬è¿ä¸€ä¸‹ã€‚æˆ‘çš„å°è±¡é‡Œæ˜¯tryåé¢åŒ…è£¹æ­£å¸¸é€»è¾‘ï¼Œå³å¯èƒ½å‡ºç°é”™è¯¯çš„ä»£ç ï¼Œç„¶ååœ¨åé¢æ¥ä¸€ä¸ªcatchè¯­å¥æ•è·é”™è¯¯ã€‚
6. resolveä½œç”¨æ˜¯åœ¨è¯·æ±‚æˆåŠŸåæ‰§è¡Œä¸€äº›æ“ä½œï¼Œå°±æ˜¯å¯¹è¿”å›çš„æ•°æ®è¿›è¡Œä¸€äº›æ“ä½œï¼Œç„¶åæ‰§è¡Œä¸€äº›è¯·æ±‚æˆåŠŸçš„é€»è¾‘ã€‚Rejectå°±ä¸ä¹‹ç›¸åï¼Œç”¨æ¥æ•è·è¿æ¥çš„é”™è¯¯ï¼Œç„¶åæŠ›å‡ºä¸€äº›å‡ºç°é”™è¯¯çš„é€»è¾‘
7. async function getData(url) {
   try {
   const res = await fetch(url);
   const data = await res.json();
   return data;
   } catch (e) {
   console.log(e);
   }
   } è¯¥å‡½æ•°ä¼šè·å–å¯¹åº”urlåœ°å€è¿”å›çš„æ•°æ®å¹¶ä¸”æ‰“å°ï¼Œå¦‚æœå‡ºç°é”™è¯¯å°±æŠ¥é”™
8. åº”è¯¥ä¼šæŒ‰ç…§é¡ºåºæŠ›å‡ºç¬¬ä¸€ä¸ªå¯¹åº”çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œå¦‚æœæœ‰finallyçš„è¯è¿˜ä¼šè¿”å›finally
9. å¯ä»¥æŠŠè¯·æ±‚æŒ‚èµ·ï¼Œè¦æ±‚åœ¨è·å¾—Aä¹‹åå‘å‡ºä¸€ä¸ªè¯·æ±‚åå†æ‰§è¡ŒBï¼Œå†æ‰§è¡ŒC
10. new Promise((resolve, reject) => {
    setTimeout(() => {
    resolve(1);
    }, 1000);
    });
