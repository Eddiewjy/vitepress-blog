## ğŸ”¥ viteæ ¸å¿ƒæ¦‚å¿µ

viteæ˜¯ä»€ä¹ˆï¼šä¸€ä¸ªåŸºäº ES æ¨¡å—ï¼ˆESMï¼‰å’ŒåŸç”Ÿæµè§ˆå™¨æ”¯æŒçš„**æ„å»ºå·¥å…·**ï¼Œä¸»è¦ç”¨äºå‰ç«¯å¼€å‘å’Œç”Ÿäº§æ„å»ºï¼Œç›¸æ¯” Webpack å…·æœ‰æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦å’Œæ›´é«˜æ•ˆçš„ HMRï¼ˆçƒ­æ›´æ–°ï¼‰ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¼˜åŒ–å¼€å‘è€…å¼€å‘ä½“éªŒçš„å·¥å…·ï¼Œæ˜¯ä¸€ä¸ª**é›†æˆå¼€å‘æœåŠ¡å™¨+ç”Ÿäº§æ„å»ºå·¥å…·**

- å¼€å‘é˜¶æ®µï¼šç›´æ¥ä½¿ç”¨ ESMï¼Œé¿å…ä¸å¿…è¦çš„æ‰“åŒ…ï¼Œé€Ÿåº¦æå¿«ã€‚
- ç”Ÿäº§é˜¶æ®µï¼šåŸºäº Rollup è¿›è¡Œä¼˜åŒ–æ‰“åŒ…ï¼Œç”Ÿæˆé«˜æ•ˆçš„é™æ€èµ„æºã€‚
### ä¸»è¦ç‰¹ç‚¹ï¼š

1. ES æ¨¡å—ï¼ˆESMï¼‰

   Vite ç›´æ¥ä½¿ç”¨åŸç”Ÿ ESMï¼ˆES Modulesï¼‰ï¼Œæµè§ˆå™¨ä¼š**æŒ‰éœ€åŠ è½½æ¨¡å—**ï¼Œè€Œä¸æ˜¯åƒ Webpack ä¸€æ ·æ‰“åŒ…æ‰€æœ‰å†…å®¹ã€‚

2. é¢„æ„å»º

   Vite åœ¨å¯åŠ¨æ—¶ï¼Œä¼š**æå‰ä¼˜åŒ–ç¬¬ä¸‰æ–¹ä¾èµ–**ï¼ˆå¦‚ Vueã€Reactï¼‰ï¼Œå°†å…¶è½¬æ¢ä¸º ESM æ ¼å¼ï¼Œæé«˜åŠ è½½é€Ÿåº¦ã€‚

   ä¼˜åŒ–çš„åŸå› ï¼š
   - é»˜è®¤çš„ npm åŒ…é€šå¸¸æ˜¯ CommonJS æ ¼å¼ï¼Œä¸é€‚ç”¨äºæµè§ˆå™¨ ESM åŠ è½½ã€‚
   - Vite ä¼šç¼“å­˜é¢„ç¼–è¯‘ç»“æœï¼ŒåŠ å¿«åç»­å¯åŠ¨é€Ÿåº¦ã€‚

3. HMR çƒ­æ¨¡å—æ›¿æ¢
   - ç›´æ¥æ›¿æ¢ å‘ç”Ÿå˜åŒ–çš„æ¨¡å—ï¼Œæ— éœ€é‡æ–°æ‰“åŒ…æ•´ä¸ªé¡¹ç›®ã€‚
   - åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚æœªæ›´æ”¹çš„æ¨¡å—ã€‚
## å¯åŠ¨è¿‡ç¨‹


```mermaid
graph TD
  %% å¼€å‘æ¨¡å¼
  subgraph Dev[Dev]
    A1[å¯åŠ¨ Vite å¼€å‘æœåŠ¡å™¨] -->|é¦–æ¬¡å¯åŠ¨| B1[ä¾èµ–é¢„æ„å»ºï¼ˆEsbuildï¼‰]
    B1 -->|ç”Ÿæˆç¼“å­˜| C1[åŠ è½½æ’ä»¶ & è®¾ç½®ä¸­é—´ä»¶]
    C1 --> |è§£ææµè§ˆå™¨è¯·æ±‚| D1[è§£æ HTML]
    D1 --> |å¤„ç† JS/CSS| E1[è§£æ & è½¬æ¢ä»£ç ]
    E1 --> |HMR ç›‘å¬| F1[çƒ­æ›´æ–°]
    F1 -->|æ›´æ–°æ¨¡å—| E1
    F1 -->|è¿”å›æ›´æ–°| G1[å®Œæˆè¯·æ±‚]
  end

  %% ç”Ÿäº§æ¨¡å¼
  subgraph Build[Build]
    A2[è§£æ Vite é…ç½®] -->|åº”ç”¨ Rollup æ’ä»¶| B2[ä»£ç å¤„ç† & Tree Shaking]
    B2 --> |èµ„æºä¼˜åŒ–| C2[å‹ç¼©ï¼ˆTerserï¼‰ & ä»£ç æ‹†åˆ†]
    C2 --> |ç”Ÿæˆ HTML/CSS/JS| D2[è¾“å‡ºåˆ° dist ç›®å½•]
  end

  %% è¿æ¥ä¸¤éƒ¨åˆ†
  Start[å¯åŠ¨ Vite] -->|dev å‘½ä»¤| Dev
  Start -->|build å‘½ä»¤| Build
```

ç›®å‰æ­£åœ¨å¼€å‘rolldownï¼ˆrustç¼–å†™çš„é«˜æ€§èƒ½åº•å±‚æ‰“åŒ…å™¨ï¼‰ä»¥æ›¿æ¢esbuildå’Œrollup